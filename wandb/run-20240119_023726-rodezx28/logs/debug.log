2024-01-19 02:37:26,958 INFO    MainThread:392108 [wandb_setup.py:_flush():76] Current SDK version is 0.16.1
2024-01-19 02:37:26,959 INFO    MainThread:392108 [wandb_setup.py:_flush():76] Configure stats pid to 392108
2024-01-19 02:37:26,959 INFO    MainThread:392108 [wandb_setup.py:_flush():76] Loading settings from /home/nmduy/.config/wandb/settings
2024-01-19 02:37:26,959 INFO    MainThread:392108 [wandb_setup.py:_flush():76] Loading settings from /home/nmduy/PiToMe/wandb/settings
2024-01-19 02:37:26,959 INFO    MainThread:392108 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-01-19 02:37:26,959 INFO    MainThread:392108 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-01-19 02:37:26,960 INFO    MainThread:392108 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'itr/main_blip.py', 'program_abspath': '/home/nmduy/PiToMe/itr/main_blip.py', 'program': '/home/nmduy/PiToMe/itr/main_blip.py'}
2024-01-19 02:37:26,960 INFO    MainThread:392108 [wandb_init.py:_log_setup():524] Logging user logs to /home/nmduy/PiToMe/wandb/run-20240119_023726-rodezx28/logs/debug.log
2024-01-19 02:37:26,960 INFO    MainThread:392108 [wandb_init.py:_log_setup():525] Logging internal logs to /home/nmduy/PiToMe/wandb/run-20240119_023726-rodezx28/logs/debug-internal.log
2024-01-19 02:37:26,960 INFO    MainThread:392108 [wandb_init.py:init():564] calling init triggers
2024-01-19 02:37:26,961 INFO    MainThread:392108 [wandb_init.py:init():571] wandb.init called with sweep_config: {}
config: {'use_graph': False, 'lr': 0.0001, 'dropout': 0.0, 'cuda': 0, 'epochs': 1, 'weight_decay': 0.0, 'optimizer': 'adam', 'momentum': 0.995, 'patience': 5, 'seed': 42, 'log_freq': 1, 'save': 0, 'save_dir': None, 'sweep_c': 0, 'lr_reduce_freq': 5000, 'gamma': 0.75, 'grad_clip': None, 'min_epochs': 2, 'mixed_precision': 'fp16', 'gradient_accumulation_steps': 1, 'lorentz_pos_margin': 0.0, 'lorentz_neg_margin': 0.8, 'euclid_pos_margin': 1.0, 'euclid_neg_margin': 0.8, 'max_txt_len': 35, 'negative_all_rank': False, 'alpha': 0.4, 'queue_size': 75000, 'batch_size': 50, 'eval_freq': 1450, 'weight_i2t': 0.5, 'enable_log': True, 'use_margin_loss': False, 'use_graph_loss': False, 'use_entailment_loss': False, 'hyp_margin_loss_weight': 0.0, 'num_proj_layers': 6, 'proj_layer_hidden_sizes': 64, 'normalize_text_embed': False, 'normalize_image_embed': False, 'shared_proj_layers': False, 'use_itm_head': True, 'use_fused_features': False, 'use_root': False, 'graph_hidden_channels': 512, 'model_ckt': 'lavis-blip-itm-base-flickr', 'manifold': 'euclidean', 'curv': 1.0, 'atol': 0.1, 'rtol': 0.1, 'temp': 0.07, 'clip_radius': 1.25, 'vision_trainable_blocks': 6, 'text_trainable_blocks': 12, 'num_vision_hidden_states': 1, 'num_text_hidden_states': 1, 'ft_out': 768, 'curv_learnable': False, 'freeze_embedding': True, 'fourier': False, 'use_last_signal': False, 'use_signal_loss': True, 'compress_method': 'PiToMe', 'distil': False, 'r': 0.925, 'dataset': 'flickr', 'cache_dir': '/mnt/data/mount_4TBSSD/nmduy/pitome/.cache', 'num_latents': 12, 'd_latents': 1024, 'num_blocks': 1, 'num_self_attends_per_block': 3, 'num_cross_attention_heads': 4, 'num_self_attention_heads': 4, 'cross_attention_widening_factor': 4, 'attention_probs_dropout_prob': 0.2, 'num_hidden_states': 2, 'use_first_layers': True}
2024-01-19 02:37:26,961 INFO    MainThread:392108 [wandb_init.py:init():614] starting backend
2024-01-19 02:37:26,961 INFO    MainThread:392108 [wandb_init.py:init():618] setting up manager
2024-01-19 02:37:26,964 INFO    MainThread:392108 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-01-19 02:37:26,967 INFO    MainThread:392108 [wandb_init.py:init():624] backend started and connected
2024-01-19 02:37:26,975 INFO    MainThread:392108 [wandb_init.py:init():716] updated telemetry
2024-01-19 02:37:26,982 INFO    MainThread:392108 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-01-19 02:37:28,468 INFO    MainThread:392108 [wandb_run.py:_on_init():2254] communicating current version
2024-01-19 02:37:28,523 INFO    MainThread:392108 [wandb_run.py:_on_init():2263] got version response upgrade_message: "wandb version 0.16.2 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-01-19 02:37:28,523 INFO    MainThread:392108 [wandb_init.py:init():800] starting run threads in backend
2024-01-19 02:37:38,484 INFO    MainThread:392108 [wandb_run.py:_console_start():2233] atexit reg
2024-01-19 02:37:38,484 INFO    MainThread:392108 [wandb_run.py:_redirect():2088] redirect: wrap_raw
2024-01-19 02:37:38,484 INFO    MainThread:392108 [wandb_run.py:_redirect():2153] Wrapping output streams.
2024-01-19 02:37:38,484 INFO    MainThread:392108 [wandb_run.py:_redirect():2178] Redirects installed.
2024-01-19 02:37:38,485 INFO    MainThread:392108 [wandb_init.py:init():841] run started, returning control to user process
2024-01-19 02:37:49,612 WARNING MsgRouterThr:392108 [router.py:message_loop():77] message_loop has been closed
